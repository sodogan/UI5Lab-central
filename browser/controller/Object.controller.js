sap.ui.define(["./BaseController","ui5lab/browser/model/formatter","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/m/library"],function(e,t,o,r,i){"use strict";var s=i.URLHelper;return e.extend("ui5lab.browser.controller.Object",{formatter:t,onInit:function(){var e,t=new o({fullscreen:false,href:"",busy:true,delay:0});this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this);e=this.getView().getBusyIndicatorDelay();this.setModel(t,"objectView");this.getOwnerComponent().getModel().loaded().then(function(){t.setProperty("/delay",e)})},onNavBack:function(){var e=r.getInstance().getPreviousHash();if(e!==undefined){history.go(-1)}else{this.getRouter().navTo("sampleList",{},true)}},toggleFullScreen:function(){var e=this.getModel("objectView");var t=e.getProperty("/fullscreen");e.setProperty("/fullscreen",!t);if(!t){this.getModel("appView").setProperty("/previousLayout",this.getModel("appView").getProperty("/layout"));this.getModel("appView").setProperty("/layout","EndColumnFullScreen")}else{this.getModel("appView").setProperty("/layout",this.getModel("appView").getProperty("/previousLayout"))}},openInNewTab:function(){s.redirect(this.getModel("objectView").getProperty("/href"),true)},onClose:function(e){this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getRouter().navTo("sampleList",{libraryId:this._sLibraryId})},_onObjectMatched:function(e){var t=e.getParameter("arguments").objectId;var o=this.getView().getParent().getParent();this._sLibraryId=e.getParameter("arguments").libraryId;this.getModel().loaded().then(function(){this._showSample(t)}.bind(this));o.setLayout(sap.f.LayoutType.ThreeColumnsEndExpanded)},_showSample:function(e){var t=this.getModel("objectView"),o=this.getModel(),r=this.getModel().getProperty("/samples"),i="/samples/";for(var s=0;s<r.length;s++){if(r[s].id===e){i+=s}}this.getView().bindElement({path:i,events:{change:this._onBindingChange.bind(this),dataRequested:function(){o.loaded().then(function(){t.setProperty("/busy",true)})},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=this.getModel("objectView"),o=e.getElementBinding(),r=o.getBoundContext().getObject();if(!o.getBoundContext()){this.getRouter().getTargets().display("objectNotFound");return}if(r.url){t.setProperty("/href",r.url)}else{var i=sap.ui.require.toUrl("libs/"+r.library.replace(/\./g,"/")+"/sample/"+r.id.split(".").pop()+".html");t.setProperty("/href",i)}t.setProperty("/busy",false)}})});